
Процедура ОбработатьВыводСборщика(_Процесс)
        Пока НЕ _Процесс.Завершен ИЛИ _Процесс.ПотокВывода.ЕстьДанные ИЛИ _Процесс.ПотокОшибок.ЕстьДанные Цикл
                Приостановить(10);
        
                ОчереднаяСтрокаВывода = _Процесс.ПотокВывода.Прочитать();
                ОчереднаяСтрокаОшибок = _Процесс.ПотокОшибок.Прочитать();
                
                Если Не ПустаяСтрока(ОчереднаяСтрокаВывода) Тогда
                        Сообщить(ОчереднаяСтрокаВывода, СтатусСообщения.Информация);
                КонецЕсли;

                Если Не ПустаяСтрока(ОчереднаяСтрокаОшибок) Тогда
                        Сообщить(ОчереднаяСтрокаОшибок, СтатусСообщения.Важное);
                КонецЕсли;
        КонецЦикла;
КонецПроцедуры


Процедура ПередУстановкой(Знач КаталогУстановкиПакета, Знач ЧтениеZipФайла) Экспорт
	//проверить GraphViz/PlantUML
КонецПроцедуры

Процедура ПриУстановке(Знач КаталогУстановкиПакета, СтандартнаяОбработка) Экспорт
	
КонецПроцедуры

Процедура ПередСборкой(Знач РабочийКаталог) Экспорт
	//Мы должны пересобрать C# pubish - чтобы обеспечить кроссплатформенность
        Сообщить("Собираю артефакт через dotnet SDK");

        Сборщик = СоздатьПроцесс("dotnet --version", , Истина);
        Сборщик.Запустить();
                
        ОбработатьВыводСборщика(Сборщик);

        Сообщить("Публикую артефакт в каталог bin");
        Скриптер = СоздатьПроцесс("dotnet publish -f netstandard2.0 --force -p:DebugType=None -c Release src/component/OMyGodEco/OMyGodEco.csproj -o bin", , Истина);
        Скриптер.Запустить();

        ОбработатьВыводСборщика(Скриптер);
        

КонецПроцедуры

Процедура ПриСборке(Знач РабочийКаталог, Знач АрхивПакета) Экспорт
        
КонецПроцедуры

Процедура ПослеСборки(Знач РабочийКаталог, Знач ПутьКФайлуПакета) Экспорт
	Сообщить("Устанавливаю пакет");
КонецПроцедуры

Описание.Имя("omygod")
        .Версия("1.0.0")
        .Автор("Al Iczin")
        .АдресАвтора("al@iczin.guru")
        .Описание("Объектная модель описание архитектуры предприятия")
        .ВерсияСреды("1.0.21")
        .ЗависитОт("oscript-config")
        .ВключитьФайл("doc")
        .ВключитьФайл("packagedef")
        .ВключитьФайл("package-loader.os")
        .ВключитьФайл("bin/OMyGodEco.dll")
        .ВключитьФайл("bin/Structurizr.Core.dll")
        .ВключитьФайл("bin/Structurizr.Client.dll")       
        .ВключитьФайл("bin/Structurizr.PlantUML.dll")
;
